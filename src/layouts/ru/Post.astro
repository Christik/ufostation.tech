---
import PostPreviews from "src/components/posts/Previews.astro";
import Post from "src/components/blog/Post.astro";
import BaseLayout from "./Base.astro";

import { getTaggedPosts } from "src/lib/posts.astro";

const {
  content: { title, url, tags = [], description, heroImage },
} = Astro.props;

const posts = await getTaggedPosts(tags, url);
---

<BaseLayout meta={{ title, description, heroImage }}>
  <Post {...Astro.props}>
    <slot />
  </Post>
  {posts.length ? <PostPreviews title="Похожие посты" posts={posts.slice(0, 3)} /> : null}
</BaseLayout>
